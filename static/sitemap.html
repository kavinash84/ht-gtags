<!doctype html>
<html lang="en">
<head>
  <title>Hometown - Sitemap</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="sitemap.css">
</head>
<body>
<div class="wrapper pb-5">
  <div class="container sitemap-wrapper">
    <div class="row mb-3">
      <div class="col-12 col-sm-12 p-0">
        <nav class="navbar navbar-light px-0">
          <a class="navbar-brand" href="/">
            <img src="logo.png" height="40px" alt="">
          </a>
        </nav>
      </div>
    </div>
    <div id="sitemapData"></div>
  </div>
</div>

<!-- <script src="assets/js/jquery-3.1.0.js"></script> -->
<script type="text/javascript">
  var data = null;

  var xhr = new XMLHttpRequest();
  xhr.withCredentials = true;

  xhr.addEventListener("readystatechange", function () {
   if (this.readyState === 4) {
     var data = this.responseText;
     var datajson = JSON.parse(this.responseText);
     // console.log(datajson);

     var dataContainer = document.getElementById('sitemapData');
     var sitemapData = '';

     for (var l1 = 0; l1 < datajson.length; l1++) {
       var level1 = datajson[l1];
       if(level1 !== undefined) {
         sitemapData += '<div class="row sitemap-block-wrapper">';
         sitemapData += '<div class="col-12 col-sm-12"><h1><a href="'+level1['url_key']+'">'+level1['name']+'</a></h1></div>';
       }
       var level2 = level1['children'];

       if(level2 !== undefined) {
         for (var l2 = 0; l2 < level2.length; l2++) {
           var level2Data = level2[l2];
           sitemapData += '<div class="col-12 col-sm-3">';
           sitemapData += '<ul class="level-2">';
           sitemapData += '<li><h2><a href="'+level2Data['url_key']+'">'+level2Data['name']+'</a></h2></li>';

           sitemapData += '<ul class="level-3">';
              var level3 = level2Data['children'];
              console.log(level3);

              if(level3 !== undefined) {
                for (var l3 = 0; l3 < level3.length; l3++) {
                  var level3Data = level3[l3];
                  sitemapData += '<li><h4><a href="'+level3Data['url_key']+'">'+level3Data['name']+'</a></h4></li>';
                }
              }
           sitemapData += '</ul>';

           sitemapData += '</ul>';
           sitemapData += '</div>';
         }
       }
       sitemapData += '</div>';
     }

     dataContainer.innerHTML += sitemapData;
     // console.log(sitemapData);
   }
  });

  xhr.open("GET", "https://stage-node.hometown.in/api/tesla/categories");
  xhr.setRequestHeader("X-SESSION-ID", "133");
  xhr.setRequestHeader("Cache-Control", "no-cache");
  // xhr.setRequestHeader("Postman-Token", "ce2523f8-9db0-4fa7-b74d-82689f9b1640");

  xhr.send(data);
</script>
</body>
</html>
